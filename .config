# 基础架构配置 (N5105 + x86_64 + ESXi)
CONFIG_TARGET_x86=y
CONFIG_TARGET_x86_64=y
CONFIG_TARGET_x86_64_Generic=y

# 固件格式 (适配ESXi虚拟化，支持VMDK/UEFI/BIOS)
CONFIG_GRUB_IMAGES=y
CONFIG_GRUB_EFI_IMAGES=y
CONFIG_TARGET_IMAGES_GZIP=y
CONFIG_TARGET_ROOTFS_EXT4FS=y
CONFIG_TARGET_ROOTFS_SQUASHFS=y
CONFIG_TARGET_ROOTFS_TARGZ=y
CONFIG_VMDK_IMAGES=y
# 扩容分区适配ESXi，避免插件安装空间不足
CONFIG_TARGET_KERNEL_PARTSIZE=128
CONFIG_TARGET_ROOTFS_PARTSIZE=896

# 内核核心优化 (N5105硬件+ESXi虚拟化+网络性能)
CONFIG_KERNEL_BUILD_USER="OpenWRT-Build"
CONFIG_KERNEL_BUILD_DOMAIN="github.com"
CONFIG_KERNEL_IPV6=y
CONFIG_KERNEL_CGROUP_NET_PRIO=y
CONFIG_KERNEL_CGROUP_BPF=y
# N5105 Intel CPU专属优化
CONFIG_KERNEL_CPU_FREQ_GOV_ONDEMAND=y
CONFIG_KERNEL_INTEL_IDLE=n
CONFIG_KERNEL_X86_INTEL_PSTATE=y
CONFIG_KERNEL_HPET_TIMER=y
CONFIG_KERNEL_NO_HZ_FULL=y
CONFIG_KERNEL_PREEMPT_NONE=y
# 网络性能核心优化(BBR拥塞算法+队列调度)
CONFIG_KERNEL_NET_SCH_FQ_CODEL=y
CONFIG_KERNEL_NET_SCH_SFQ=y
CONFIG_KERNEL_NET_CLS_ACT=y
CONFIG_KERNEL_NET_ACT_MIRRED=y
CONFIG_KERNEL_TCP_CONG_BBR=y
CONFIG_KERNEL_TCP_FASTOPEN=y
# 虚拟化中断优化
CONFIG_KERNEL_IRQ_FORCED_THREADING=y
CONFIG_KERNEL_SMP=y

# 基础系统组件 (保留原功能，补充虚拟化工具)
CONFIG_PACKAGE_base-files=y
CONFIG_PACKAGE_bash=y
CONFIG_PACKAGE_coreutils=y
CONFIG_PACKAGE_coreutils-nohup=y
CONFIG_PACKAGE_curl=y
CONFIG_PACKAGE_wget=y
CONFIG_PACKAGE_unzip=y
CONFIG_PACKAGE_zip=y
CONFIG_PACKAGE_tar=y
CONFIG_PACKAGE_gzip=y
CONFIG_PACKAGE_bzip2=y
CONFIG_PACKAGE_7z=y
CONFIG_PACKAGE_vim-full=y
CONFIG_PACKAGE_tree=y
CONFIG_PACKAGE_procps-ng=y
CONFIG_PACKAGE_nano=y
# 补充N5105/ESXi工具
CONFIG_PACKAGE_ethtool=y
CONFIG_PACKAGE_lm-sensors=y
CONFIG_PACKAGE_open-vm-tools=y
CONFIG_PACKAGE_pciutils=y
CONFIG_PACKAGE_usbutils=y

# 网络基础组件 (强化虚拟化网络转发，适配ESXi VMXNET3)
CONFIG_PACKAGE_dnsmasq-full=y
CONFIG_PACKAGE_dnsmasq_full_dhcpv6=y
CONFIG_PACKAGE_dnsmasq_full_auth=y
CONFIG_PACKAGE_ip6tables=y
CONFIG_PACKAGE_iptables-mod-tproxy=y
CONFIG_PACKAGE_iptables-mod-extra=y
CONFIG_PACKAGE_ipset=y
CONFIG_PACKAGE_iproute2=y
CONFIG_PACKAGE_tcpdump=y
CONFIG_PACKAGE_ss=y
CONFIG_PACKAGE_nftables=y
CONFIG_PACKAGE_odhcp6c=y
CONFIG_PACKAGE_odhcpd-ipv6only=y
CONFIG_PACKAGE_ppp=y
CONFIG_PACKAGE_ppp-mod-pppoe=y
CONFIG_PACKAGE_wireless-tools=y
CONFIG_PACKAGE_wpa-supplicant=y
# 网络调优工具
CONFIG_PACKAGE_irqbalance=y
CONFIG_PACKAGE_nload=y
CONFIG_PACKAGE_iftop=y

# Web 管理界面 (LuCI) 保留原配置，精简无用主题
CONFIG_PACKAGE_luci=y
CONFIG_PACKAGE_luci-base=y
CONFIG_PACKAGE_luci-compat=y
CONFIG_PACKAGE_luci-lib-ip=y
CONFIG_PACKAGE_luci-lib-jsonc=y
CONFIG_PACKAGE_luci-lib-nixio=y
CONFIG_PACKAGE_luci-mod-admin-full=y
CONFIG_PACKAGE_luci-theme-argon=y
CONFIG_PACKAGE_luci-app-argon-config=n
# 保留基础主题，移除冗余
CONFIG_PACKAGE_luci-theme-bootstrap=y
CONFIG_PACKAGE_luci-theme-design=n
CONFIG_PACKAGE_luci-theme-opentomcat=n

# OpenClash 专属优化 (修复nil错误+ESXi虚拟化适配)
CONFIG_PACKAGE_luci-app-openclash=y
CONFIG_PACKAGE_luci-i18n-openclash-zh-cn=y
CONFIG_PACKAGE_openclash=y
CONFIG_PACKAGE_clash=y
CONFIG_PACKAGE_glib2=y
CONFIG_PACKAGE_libcap=y
CONFIG_PACKAGE_libcap-bin=y
CONFIG_PACKAGE_libyaml=y
CONFIG_PACKAGE_rclone=y
CONFIG_PACKAGE_curl=y
# 补充OpenClash网络转发依赖
CONFIG_PACKAGE_kmod-tun=y
CONFIG_PACKAGE_kmod-nf-nat-tproxy=y
CONFIG_PACKAGE_iproute2-tc=y

# 常用网络插件 (保留原实用插件，补充ESXi适配)
CONFIG_PACKAGE_luci-app-accesscontrol=y
CONFIG_PACKAGE_luci-app-ddns=y
CONFIG_PACKAGE_luci-app-diskman=y
CONFIG_PACKAGE_luci-app-firewall=y
CONFIG_PACKAGE_luci-app-ipsec-vpnd=y
CONFIG_PACKAGE_luci-app-nlbwmon=y
CONFIG_PACKAGE_luci-app-onliner=y
CONFIG_PACKAGE_luci-app-poweroff=y
CONFIG_PACKAGE_luci-app-samba4=y
CONFIG_PACKAGE_luci-app-wol=y


# 关闭无用插件
# CONFIG_PACKAGE_luci-app-autoreboot is not set
# CONFIG_PACKAGE_luci-app-adbyby-plus is not set
# CONFIG_PACKAGE_luci-app-adguardhome is not set
# CONFIG_PACKAGE_luci-app-alist is not set
# CONFIG_PACKAGE_luci-app-arpbind is not set
# CONFIG_PACKAGE_luci-app-cifs-mount is not set
# CONFIG_PACKAGE_luci-app-dockerman is not set
# CONFIG_PACKAGE_luci-app-filetransfer is not set
# CONFIG_PACKAGE_luci-app-frpc is not set
# CONFIG_PACKAGE_luci-app-mosdns is not set
# CONFIG_PACKAGE_luci-app-netdata is not set
# CONFIG_PACKAGE_luci-app-passwall is not set
# CONFIG_PACKAGE_luci-app-passwall2 is not set
# CONFIG_PACKAGE_luci-app-ramfree is not set
# CONFIG_PACKAGE_luci-app-rclone_INCLUDE_rclone-ng is not set
# CONFIG_PACKAGE_luci-app-rclone_INCLUDE_rclone-webui is not set
# CONFIG_PACKAGE_luci-app-samba is not set
# CONFIG_PACKAGE_luci-app-smartdns is not set
# CONFIG_PACKAGE_luci-app-ssr-plus is not set
# CONFIG_PACKAGE_luci-app-turboacc is not set
# CONFIG_PACKAGE_luci-app-unblockmusic is not set
# CONFIG_PACKAGE_luci-app-upnp is not set
# CONFIG_PACKAGE_luci-app-vlmcsd is not set
# CONFIG_PACKAGE_luci-app-vsftpd is not set
# CONFIG_PACKAGE_luci-app-vssr is not set
# CONFIG_PACKAGE_luci-app-vssr_INCLUDE_Kcptun is not set
# CONFIG_PACKAGE_luci-app-ttyd is not set
# CONFIG_PACKAGE_luci-app-wireguard is not set
# CONFIG_PACKAGE_luci-app-wrtbwmon is not set
# CONFIG_PACKAGE_luci-app-xlnetacc is not set
# CONFIG_PACKAGE_luci-app-zerotier is not set

# 存储相关 (ESXi PVSCSI控制器+多格式支持)
CONFIG_PACKAGE_block-mount=y
CONFIG_PACKAGE_kmod-fs-ext4=y
CONFIG_PACKAGE_kmod-fs-ntfs=y
CONFIG_PACKAGE_kmod-fs-exfat=y
CONFIG_PACKAGE_kmod-usb-storage=y
CONFIG_PACKAGE_kmod-usb-storage-uas=y
CONFIG_PACKAGE_kmod-usb-ohci=y
CONFIG_PACKAGE_kmod-usb-uhci=y
CONFIG_PACKAGE_kmod-usb2=y
CONFIG_PACKAGE_kmod-usb3=y
# ESXi PVSCSI磁盘控制器专属驱动
CONFIG_PACKAGE_kmod-scsi-vmw-pvscsi=y

# 性能优化 (N5105专属，强化虚拟化性能)
CONFIG_PACKAGE_irqbalance=y
CONFIG_PACKAGE_htop=y
CONFIG_PACKAGE_zram-swap=y
# 内存优化
CONFIG_PACKAGE_zram-tools=y
CONFIG_PACKAGE_swapspace=y

# 移除不必要的组件 (减小固件体积，提升运行效率)
CONFIG_PACKAGE_ppp-mod-pptp=n
CONFIG_PACKAGE_ppp-mod-l2tp=n
CONFIG_PACKAGE_ppp-mod-pppoa=n
CONFIG_PACKAGE_automount=n
CONFIG_PACKAGE_autosamba=n
# 移除无用无线驱动(ESXi虚拟化无需物理无线)
CONFIG_PACKAGE_kmod-ath9k=n
CONFIG_PACKAGE_kmod-ath10k=n
CONFIG_PACKAGE_kmod-mt7601u=n
CONFIG_PACKAGE_kmod-mt7612u=n
